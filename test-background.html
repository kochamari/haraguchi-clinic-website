<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPhone背景テスト - 原口消化器内科</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            min-height: 100vh;
            background-color: #e3f2fd;
        }
        
        @media (max-width: 768px) {
            html body {
                background-color: #e3f2fd !important;
                background-image: 
                    linear-gradient(45deg, rgba(173, 216, 230, 0.8) 25%, transparent 25%),
                    linear-gradient(-45deg, rgba(127, 179, 213, 0.7) 25%, transparent 25%),
                    linear-gradient(45deg, transparent 75%, rgba(99, 187, 208, 0.75) 75%),
                    linear-gradient(-45deg, transparent 75%, rgba(135, 206, 235, 0.65) 75%) !important;
                background-size: 20px 20px !important;
                background-position: 0 0, 0 10px, 10px -10px, -10px 0px !important;
                min-height: 100vh !important;
            }
        }
        
        .test-container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            margin-top: 50px;
        }
        
        .test-result {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #2196f3;
            background: rgba(33, 150, 243, 0.1);
        }
        
        .success { border-left-color: #4caf50; background: rgba(76, 175, 80, 0.1); }
        .error { border-left-color: #f44336; background: rgba(244, 67, 54, 0.1); }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>iPhone背景表示テスト</h1>
        <p>このページでiPhone背景の原因究明を行います。</p>
        
        <div id="device-info" class="test-result">
            <strong>デバイス検出中...</strong>
        </div>
        
        <div id="background-info" class="test-result">
            <strong>背景情報取得中...</strong>
        </div>
        
        <div id="css-info" class="test-result">
            <strong>CSS情報確認中...</strong>
        </div>
        
        <div id="force-result" class="test-result">
            <strong>強制適用結果...</strong>
        </div>
        
        <a href="index.html" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #2196f3; color: white; text-decoration: none; border-radius: 5px;">メインページに戻る</a>
    </div>

    <script>
        const deviceInfo = document.getElementById('device-info');
        const backgroundInfo = document.getElementById('background-info');
        const cssInfo = document.getElementById('css-info');
        const forceResult = document.getElementById('force-result');
        
        // デバイス検出
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                      (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
        const isMobile = window.innerWidth <= 768;
        
        deviceInfo.innerHTML = `
            <strong>デバイス情報:</strong><br>
            iOS: ${isIOS ? '✅' : '❌'}<br>
            Safari: ${isSafari ? '✅' : '❌'}<br>
            モバイル幅: ${isMobile ? '✅' : '❌'}<br>
            画面幅: ${window.innerWidth}px<br>
            User Agent: ${navigator.userAgent}
        `;
        deviceInfo.className = `test-result ${isIOS ? 'success' : ''}`;
        
        // 背景情報取得
        const body = document.body;
        const computedStyle = window.getComputedStyle(body);
        
        backgroundInfo.innerHTML = `
            <strong>現在の背景:</strong><br>
            Background Color: ${computedStyle.backgroundColor}<br>
            Background Image: ${computedStyle.backgroundImage}<br>
            Background Size: ${computedStyle.backgroundSize}<br>
            Background Position: ${computedStyle.backgroundPosition}
        `;
        
        // CSS適用確認
        cssInfo.innerHTML = `
            <strong>CSS状態:</strong><br>
            メディアクエリ適用: ${window.matchMedia('(max-width: 768px)').matches ? '✅' : '❌'}<br>
            ViewPort幅: ${window.innerWidth}px<br>
            ViewPort高さ: ${window.innerHeight}px
        `;
        
        // 強制適用テスト（iOS/モバイルの場合のみ）
        if (isIOS || isMobile) {
            setTimeout(() => {
                console.log('🔍 強制背景適用テスト開始');
                
                body.style.setProperty('background-color', '#bbdefb', 'important');
                body.style.setProperty('background-image', `
                    linear-gradient(45deg, rgba(173, 216, 230, 0.9) 25%, transparent 25%),
                    linear-gradient(-45deg, rgba(127, 179, 213, 0.8) 25%, transparent 25%),
                    linear-gradient(45deg, transparent 75%, rgba(99, 187, 208, 0.85) 75%),
                    linear-gradient(-45deg, transparent 75%, rgba(135, 206, 235, 0.75) 75%)
                `, 'important');
                body.style.setProperty('background-size', '15px 15px', 'important');
                body.style.setProperty('background-position', '0 0, 0 7px, 7px -7px, -7px 0px', 'important');
                
                setTimeout(() => {
                    const newStyle = window.getComputedStyle(body);
                    const hasPattern = newStyle.backgroundImage !== 'none' && newStyle.backgroundImage !== '';
                    
                    forceResult.innerHTML = `
                        <strong>強制適用結果:</strong><br>
                        背景パターン表示: ${hasPattern ? '✅ 成功' : '❌ 失敗'}<br>
                        新しい背景色: ${newStyle.backgroundColor}<br>
                        新しい背景画像: ${newStyle.backgroundImage.substring(0, 100)}...
                    `;
                    forceResult.className = `test-result ${hasPattern ? 'success' : 'error'}`;
                    
                    console.log('✅ テスト完了:', hasPattern ? '成功' : '失敗');
                }, 500);
            }, 1000);
        } else {
            forceResult.innerHTML = '<strong>デスクトップのため強制適用テストはスキップ</strong>';
        }
    </script>
</body>
</html>